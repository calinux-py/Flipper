DELAY 500
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000
STRING $connections = Get-NetTCPConnection | ?{$_.State -eq 'Established'}
ENTER
STRING $openPorts = $connections | select -ExpandProperty LocalPort | sort -Unique
ENTER
STRING $filePath = "$env:TEMP\CaliPortsOpen_$env:COMPUTERNAME_$(Get-Date -Format 'yyyyMMdd').txt"
ENTER
STRING $currentNumber = $openPorts.Count
ENTER
STRING "`nOPEN PORTS: $currentNumber" | Out-File -FilePath $filePath
ENTER
STRING $openPorts | %{$portCount=1}{$port=$_;($connections|?{$_.LocalPort -eq $port}).RemotePort|select -Unique|%{"`n$portCount. [Local Port]: $port <--> [Remote Port]: $_" | Out-File -FilePath $filePath -Append;$portCount++}}
ENTER
DELAY 200
STRING exit
DELAY 500
ENTER
